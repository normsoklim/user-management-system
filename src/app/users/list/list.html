<div class="user-list-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">User Management</h1>
      <p class="page-subtitle">Manage and organize your team members</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-outline-primary" (click)="exportUsers()">
        <i class="fas fa-download"></i>
        Export
      </button>
      <button class="btn btn-primary" (click)="createUser()">
        <i class="fas fa-plus"></i>
        Add User
      </button>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filters-header">
      <h2 class="filters-title">Filters</h2>
      <button class="btn btn-text clear-filters-btn" (click)="clearFilters()">
        <i class="fas fa-times"></i>
        Clear Filters
      </button>
    </div>
    <div class="filters-row">
      <div class="search-box">
        <input
          type="text"
          class="form-control"
          placeholder="Search users..."
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
        />
        <button class="search-btn" (click)="onSearch()">
          <i class="fas fa-search"></i>
        </button>
      </div>

      <select class="form-control" [(ngModel)]="selectedRole" (change)="onFilterChange()">
        <option value="">All Roles</option>
        <option *ngFor="let role of availableRoles" [value]="role.id">
          {{ role.name | titlecase }}
        </option>
      </select>

      <select class="form-control" [(ngModel)]="selectedStatus" (change)="onFilterChange()">
        <option value="">All Status</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>

      <select class="form-control" [(ngModel)]="pageSize" (change)="onPageSizeChange()">
        <option [value]="10">10 per page</option>
        <option [value]="25">25 per page</option>
        <option [value]="50">50 per page</option>
        <option [value]="100">100 per page</option>
      </select>
    </div>
  </div>

  <!-- Table Section -->
  <div class="table-container" *ngIf="!isLoading">
    <table class="users-table">
      <thead>
        <tr>
          <th (click)="onSort('firstName')">
            User
            <i class="sort-icon" [class]="getSortIcon('firstName')"></i>
          </th>
          <th (click)="onSort('email')">
            Email
            <i class="sort-icon" [class]="getSortIcon('email')"></i>
          </th>
          <th (click)="onSort('roles')">
            Roles
            <i class="sort-icon" [class]="getSortIcon('roles')"></i>
          </th>
          <th (click)="onSort('isActive')">
            Status
            <i class="sort-icon" [class]="getSortIcon('isActive')"></i>
          </th>
          <th (click)="onSort('createdAt')">
            Created
            <i class="sort-icon" [class]="getSortIcon('createdAt')"></i>
          </th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users; let i = index" [class.inactive]="!user.isActive" [style.--row-index]="i">
          <td>
            <div class="user-info">
              <div class="user-avatar">
                <img *ngIf="user.avatar; else initials" [src]="user.avatar" [alt]="user.firstName + ' ' + user.lastName" class="avatar-img">
                <ng-template #initials>
                  <div class="avatar-initials">
                    {{ user.firstName.charAt(0).toUpperCase() }}{{ user.lastName.charAt(0).toUpperCase() }}
                  </div>
                </ng-template>
              </div>
              <div class="user-name">
                <div class="name" appHighlight [appHighlight]="searchQuery">
                  {{ user.firstName }} {{ user.lastName }}
                </div>
              </div>
            </div>
          </td>
          <td class="email">{{ user.email }}</td>
          <td>
            <div class="roles-info">
              <span class="role-badge" *ngFor="let role of user.roles">
                {{ role | titlecase }}
              </span>
            </div>
          </td>
          <td>
            <span class="status-badge" [class.active]="user.isActive" [class.inactive]="!user.isActive">
              {{ user.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td class="date">{{ user.createdAt | appDate:'medium' }}</td>
          <td class="actions">
            <div class="action-buttons">
              <button class="btn btn-sm btn-outline-primary" (click)="editUser(user.id)" title="Edit">
                <i class="fas fa-edit"></i>
              </button>
              <button
                class="btn btn-sm"
                [class.btn-outline-success]="!user.isActive"
                [class.btn-outline-warning]="user.isActive"
                (click)="toggleUserStatus(user)"
                [title]="user.isActive ? 'Deactivate' : 'Activate'"
              >
                <i class="fas" [class.fa-toggle-off]="!user.isActive" [class.fa-toggle-on]="user.isActive"></i>
              </button>
              <button class="btn btn-sm btn-outline-info" (click)="resetPassword(user)" title="Reset Password">
                <i class="fas fa-key"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="deleteUser(user)" title="Delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="empty-state" *ngIf="users.length === 0">
      <i class="fas fa-users empty-icon"></i>
      <h3>No users found</h3>
      <p>Try adjusting your search criteria or create a new user.</p>
      <button class="btn btn-primary" (click)="createUser()">
        <i class="fas fa-plus"></i>
        Add Your First User
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Loading users...</p>
  </div>

  <!-- Pagination Section -->
  <div class="pagination-section" *ngIf="totalPages > 1">
    <div class="pagination-info">
      Showing {{ (currentPage - 1) * pageSize + 1 }} to
      {{ Math.min(currentPage * pageSize, totalUsers) }} of {{ totalUsers }} users
    </div>
    
    <div class="pagination">
      <button
        class="btn btn-outline-primary"
        [disabled]="currentPage === 1"
        (click)="onPageChange(currentPage - 1)"
      >
        <i class="fas fa-chevron-left"></i>
        Previous
      </button>
      
      <button
        *ngFor="let page of getPaginationArray()"
        class="btn"
        [class.btn-primary]="page === currentPage"
        [class.btn-outline-primary]="page !== currentPage"
        (click)="onPageChange(page)"
      >
        {{ page }}
      </button>
      
      <button
        class="btn btn-outline-primary"
        [disabled]="currentPage === totalPages"
        (click)="onPageChange(currentPage + 1)"
      >
        Next
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>